
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Pattern Formation PDE – Finite Difference &#8212; NumSA 0.0.1 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Partial Differential Equations (PDE)" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Pattern-Formation-PDE-–-Finite-Difference">
<h1>Pattern Formation PDE – Finite Difference<a class="headerlink" href="#Pattern-Formation-PDE-–-Finite-Difference" title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="kn">import</span> <span class="nn">scipy.integrate</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="k">as</span> <span class="nn">animation</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">sparse</span>
<span class="kn">from</span> <span class="nn">scipy.sparse.linalg</span> <span class="kn">import</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">spsolve</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">trange</span><span class="p">,</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">nodepy.runge_kutta_method</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<p>We are interested in solving numerically the following system of reaction-diffusion PDE:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{cases}
    \partial_t u = \delta_1(\partial^2_x u + \partial^2_y u)+\alpha u(1-\tau_1v^2)+v(1-\tau_2u)\\\\
    \partial_t v = \delta_2(\partial^2_x v + \partial^2_y v)+\beta v(1-\frac{\alpha\tau_1}{\beta}uv)+u(\gamma+\tau_2u)
\end{cases}\end{split}\]</div>
<p>and we can separate the diffusion terms from the reactions term, obtaining,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{cases}
    \partial_t u = \nabla^2\cdot u + f(u,v) \\\\
    \partial_t v = \nabla^2\cdot v + g(u,v)
\end{cases}\end{split}\]</div>
<p>where the functions <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span> are clearly defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{gather}
    f(u,v) = \alpha u(1-\tau_1v^2)+v(1-\tau_2u),\\
    g(u,v) = \beta v(1-\frac{\alpha\tau_1}{\beta}uv)+u(\gamma+\tau_2u).
\end{gather}\end{split}\]</div>
<p>in particular we focus our attention on solving the above coupled system of autonomous ordinary differential equations reppresenting the reaction part of the Turing model. In particular we will solve these implementing a 4th order Runge-Kutta method.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">class</span> <span class="nc">ODESol</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">timesteps</span><span class="p">,</span><span class="n">timestep</span><span class="p">,</span><span class="n">U</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">timesteps</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">timestep</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">U</span><span class="p">;</span>
<span class="k">def</span> <span class="nf">RK4</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">U0</span><span class="p">,</span><span class="n">arg</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">);</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">tt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tt</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">U0</span><span class="p">),</span><span class="n">N</span><span class="p">]);</span>
    <span class="n">U</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">U0</span><span class="p">;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">trange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">Y1</span> <span class="o">=</span> <span class="n">U</span><span class="p">[:,</span><span class="n">i</span><span class="p">];</span>
        <span class="n">Y2</span> <span class="o">=</span> <span class="n">U</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">tt</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">Y1</span><span class="p">,</span><span class="n">arg</span><span class="p">);</span>
        <span class="n">Y3</span> <span class="o">=</span> <span class="n">U</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">tt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="p">,</span><span class="n">Y2</span><span class="p">,</span><span class="n">arg</span><span class="p">);</span>
        <span class="n">Y4</span> <span class="o">=</span> <span class="n">U</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">tt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="p">,</span><span class="n">Y3</span><span class="p">,</span><span class="n">arg</span><span class="p">);</span>
        <span class="n">U</span><span class="p">[:,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">U</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">tt</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">Y1</span><span class="p">,</span><span class="n">arg</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">tt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="p">,</span><span class="n">Y2</span><span class="p">,</span><span class="n">arg</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">tt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="p">,</span><span class="n">Y3</span><span class="p">,</span><span class="n">arg</span><span class="p">)</span><span class="o">+</span><span class="n">F</span><span class="p">(</span><span class="n">tt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">h</span><span class="p">,</span><span class="n">Y4</span><span class="p">,</span><span class="n">arg</span><span class="p">))</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">ODESol</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">U</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">sol</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="Reaction">
<h2>Reaction<a class="headerlink" href="#Reaction" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Table</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">Table</span> <span class="o">=</span> <span class="n">Table</span> <span class="o">+</span> <span class="p">[{</span><span class="s2">&quot;delta1&quot;</span><span class="p">:</span><span class="mf">0.00225</span><span class="p">,</span><span class="s2">&quot;delta2&quot;</span><span class="p">:</span><span class="mf">0.0045</span><span class="p">,</span><span class="s2">&quot;tau1&quot;</span><span class="p">:</span><span class="mf">0.02</span><span class="p">,</span><span class="s2">&quot;tau2&quot;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span><span class="mf">0.899</span><span class="p">,</span><span class="s2">&quot;beta&quot;</span><span class="p">:</span><span class="o">-</span><span class="mf">0.91</span><span class="p">,</span><span class="s2">&quot;gamma&quot;</span><span class="p">:</span><span class="o">-</span><span class="mf">0.899</span><span class="p">}]</span>
<span class="n">Table</span> <span class="o">=</span> <span class="n">Table</span> <span class="o">+</span> <span class="p">[{</span><span class="s2">&quot;delta1&quot;</span><span class="p">:</span><span class="mf">0.001</span><span class="p">,</span><span class="s2">&quot;delta2&quot;</span><span class="p">:</span><span class="mf">0.0045</span><span class="p">,</span><span class="s2">&quot;tau1&quot;</span><span class="p">:</span><span class="mf">0.02</span><span class="p">,</span><span class="s2">&quot;tau2&quot;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span><span class="mf">0.899</span><span class="p">,</span><span class="s2">&quot;beta&quot;</span><span class="p">:</span><span class="o">-</span><span class="mf">0.91</span><span class="p">,</span><span class="s2">&quot;gamma&quot;</span><span class="p">:</span><span class="o">-</span><span class="mf">0.899</span><span class="p">}]</span>
<span class="n">Table</span> <span class="o">=</span> <span class="n">Table</span> <span class="o">+</span> <span class="p">[{</span><span class="s2">&quot;delta1&quot;</span><span class="p">:</span><span class="mf">0.00225</span><span class="p">,</span><span class="s2">&quot;delta2&quot;</span><span class="p">:</span><span class="mf">0.0045</span><span class="p">,</span><span class="s2">&quot;tau1&quot;</span><span class="p">:</span><span class="mf">0.02</span><span class="p">,</span><span class="s2">&quot;tau2&quot;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span><span class="mf">1.9</span><span class="p">,</span><span class="s2">&quot;beta&quot;</span><span class="p">:</span><span class="o">-</span><span class="mf">0.91</span><span class="p">,</span><span class="s2">&quot;gamma&quot;</span><span class="p">:</span><span class="o">-</span><span class="mf">1.9</span><span class="p">}]</span>

<span class="n">Table</span> <span class="o">=</span> <span class="n">Table</span> <span class="o">+</span> <span class="p">[{</span><span class="s2">&quot;delta1&quot;</span><span class="p">:</span><span class="mf">0.00225</span><span class="p">,</span><span class="s2">&quot;delta2&quot;</span><span class="p">:</span><span class="mf">0.0045</span><span class="p">,</span><span class="s2">&quot;tau1&quot;</span><span class="p">:</span><span class="mf">2.02</span><span class="p">,</span><span class="s2">&quot;tau2&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span><span class="s2">&quot;beta&quot;</span><span class="p">:</span><span class="o">-</span><span class="mf">0.91</span><span class="p">,</span><span class="s2">&quot;gamma&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">}]</span>
<span class="n">Table</span> <span class="o">=</span> <span class="n">Table</span> <span class="o">+</span> <span class="p">[{</span><span class="s2">&quot;delta1&quot;</span><span class="p">:</span><span class="mf">0.00105</span><span class="p">,</span><span class="s2">&quot;delta2&quot;</span><span class="p">:</span><span class="mf">0.0021</span><span class="p">,</span><span class="s2">&quot;tau1&quot;</span><span class="p">:</span><span class="mf">3.5</span><span class="p">,</span><span class="s2">&quot;tau2&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span><span class="mf">0.899</span><span class="p">,</span><span class="s2">&quot;beta&quot;</span><span class="p">:</span><span class="o">-</span><span class="mf">0.91</span><span class="p">,</span><span class="s2">&quot;gamma&quot;</span><span class="p">:</span><span class="o">-</span><span class="mf">0.899</span><span class="p">}]</span>
<span class="n">Table</span> <span class="o">=</span> <span class="n">Table</span> <span class="o">+</span> <span class="p">[{</span><span class="s2">&quot;delta1&quot;</span><span class="p">:</span><span class="mf">0.00225</span><span class="p">,</span><span class="s2">&quot;delta2&quot;</span><span class="p">:</span><span class="mf">0.0045</span><span class="p">,</span><span class="s2">&quot;tau1&quot;</span><span class="p">:</span><span class="mf">0.02</span><span class="p">,</span><span class="s2">&quot;tau2&quot;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span><span class="mf">1.9</span><span class="p">,</span><span class="s2">&quot;beta&quot;</span><span class="p">:</span><span class="o">-</span><span class="mf">0.85</span><span class="p">,</span><span class="s2">&quot;gamma&quot;</span><span class="p">:</span><span class="o">-</span><span class="mf">1.9</span><span class="p">}]</span>
<span class="n">Table</span> <span class="o">=</span> <span class="n">Table</span> <span class="o">+</span> <span class="p">[{</span><span class="s2">&quot;delta1&quot;</span><span class="p">:</span><span class="mf">0.00225</span><span class="p">,</span><span class="s2">&quot;delta2&quot;</span><span class="p">:</span><span class="mf">0.0005</span><span class="p">,</span><span class="s2">&quot;tau1&quot;</span><span class="p">:</span><span class="mf">2.02</span><span class="p">,</span><span class="s2">&quot;tau2&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span><span class="s2">&quot;beta&quot;</span><span class="p">:</span><span class="o">-</span><span class="mf">0.91</span><span class="p">,</span><span class="s2">&quot;gamma&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">}]</span>

<span class="k">def</span> <span class="nf">Reaction</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">parameters</span><span class="p">):</span>
    <span class="c1">#The ODE is autonomus so we don&#39;t really need</span>
    <span class="c1">#the depende on time.</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">v</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="c1">#We grab the useful quantity.</span>
    <span class="n">d1</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;delta1&quot;</span><span class="p">];</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;delta2&quot;</span><span class="p">];</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;tau1&quot;</span><span class="p">];</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;tau2&quot;</span><span class="p">];</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">];</span> <span class="n">b</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;beta&quot;</span><span class="p">];</span> <span class="n">g</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;gamma&quot;</span><span class="p">];</span>
    <span class="n">du</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">u</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">t1</span><span class="o">*</span><span class="p">(</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="n">v</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">t2</span><span class="o">*</span><span class="n">u</span><span class="p">);</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">t1</span><span class="o">/</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="p">))</span><span class="o">+</span><span class="n">u</span><span class="o">*</span><span class="p">(</span><span class="n">g</span><span class="o">+</span><span class="n">t2</span><span class="o">*</span><span class="n">v</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">du</span><span class="p">,</span><span class="n">dv</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">t0</span> <span class="o">=</span> <span class="mf">0.</span>                  <span class="c1"># Initial time</span>
<span class="n">u0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">])</span><span class="c1"># Initial values</span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">100.</span>              <span class="c1"># Final time</span>
<span class="n">dt_output</span><span class="o">=</span><span class="mf">0.1</span><span class="c1"># Interval between output for plotting</span>
<span class="n">N</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">dt_output</span><span class="p">)</span>       <span class="c1"># Number of output times</span>
<span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">tt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span><span class="n">tfinal</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># Output times</span>
<span class="n">ODE</span> <span class="o">=</span> <span class="n">RK4</span><span class="p">(</span><span class="n">Reaction</span><span class="p">,[</span><span class="n">t0</span><span class="p">,</span><span class="n">tfinal</span><span class="p">],</span><span class="n">u0</span><span class="p">,</span><span class="n">Table</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="n">N</span><span class="p">);</span>
<span class="n">uu</span><span class="o">=</span><span class="n">ODE</span><span class="o">.</span><span class="n">y</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">uu</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">tt</span><span class="p">,</span><span class="n">uu</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;u&quot;</span><span class="p">,</span><span class="s2">&quot;v&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1000
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "6b8f62f851dc427aa699456a252843d1", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7f32bbb97940&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_6_3.png" src="../_images/PDE_PatternFormationFD_6_3.png" />
</div>
</div>
</div>
<div class="section" id="Diffusion">
<h2>Diffusion<a class="headerlink" href="#Diffusion" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">laplacian_1D</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">em</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">e1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">sparse</span><span class="o">.</span><span class="n">diags</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">em</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">sparse</span><span class="o">.</span><span class="n">diags</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">sparse</span><span class="o">.</span><span class="n">diags</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">tocsr</span><span class="p">();</span>
    <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="p">((</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">A</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="p">((</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">A</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">spy</span><span class="p">(</span><span class="n">laplacian_1D</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/uzerbinati/.local/lib/python3.8/site-packages/scipy/sparse/_index.py:82: SparseEfficiencyWarning: Changing the sparsity structure of a csr_matrix is expensive. lil_matrix is more efficient.
  self._set_intXint(row, col, x.flat[0])
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.lines.Line2D at 0x7f32bb1c5d90&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_9_2.png" src="../_images/PDE_PatternFormationFD_9_2.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">laplacian_2D</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">laplacian_1D</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sparse</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">sparse</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">spy</span><span class="p">(</span><span class="n">laplacian_2D</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.lines.Line2D at 0x7f32bb1ad6d0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_11_1.png" src="../_images/PDE_PatternFormationFD_11_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span><span class="o">=</span><span class="mi">100</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="o">+</span><span class="mi">2</span><span class="p">);</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="o">+</span><span class="mi">2</span><span class="p">);</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">A</span><span class="o">=</span><span class="n">laplacian_2D</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">spy</span><span class="p">(</span><span class="n">sparse</span><span class="o">.</span><span class="n">bmat</span><span class="p">([[</span><span class="mi">2</span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="kc">None</span><span class="p">],[</span><span class="kc">None</span><span class="p">,</span><span class="mi">1</span><span class="o">*</span><span class="n">A</span><span class="p">]]))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.01980198019801982
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.lines.Line2D at 0x7f32bb12d5b0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_12_2.png" src="../_images/PDE_PatternFormationFD_12_2.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">Diffusion</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">parameters</span><span class="p">):</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">bmat</span><span class="p">([[</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;delta1&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="kc">None</span><span class="p">],[</span><span class="kc">None</span><span class="p">,</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;delta2&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">]]);</span>
    <span class="k">return</span> <span class="n">B</span><span class="o">*</span><span class="n">x</span><span class="p">;</span>
<span class="c1">#Generating the initial data</span>
<span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span> <span class="c1"># mean and standard deviation</span>
<span class="n">u0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">);</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">#Plotting the initial data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">U0</span><span class="o">=</span><span class="n">u0</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">m</span><span class="p">,</span><span class="n">m</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">V0</span><span class="o">=</span><span class="n">v0</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">m</span><span class="p">,</span><span class="n">m</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">V0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
&lt;ipython-input-10-5d9199957f96&gt;:11: MatplotlibDeprecationWarning: shading=&#39;flat&#39; when X and Y have the same dimensions as C is deprecated since 3.3.  Either specify the corners of the quadrilaterals with X and Y, or pass shading=&#39;auto&#39;, &#39;nearest&#39; or &#39;gouraud&#39;, or set rcParams[&#39;pcolor.shading&#39;].  This will become an error two minor releases later.
  plt.pcolor(X,Y,U0)
&lt;ipython-input-10-5d9199957f96&gt;:15: MatplotlibDeprecationWarning: shading=&#39;flat&#39; when X and Y have the same dimensions as C is deprecated since 3.3.  Either specify the corners of the quadrilaterals with X and Y, or pass shading=&#39;auto&#39;, &#39;nearest&#39; or &#39;gouraud&#39;, or set rcParams[&#39;pcolor.shading&#39;].  This will become an error two minor releases later.
  plt.pcolor(X,Y,V0)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_13_1.png" src="../_images/PDE_PatternFormationFD_13_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_13_2.png" src="../_images/PDE_PatternFormationFD_13_2.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">TIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mf">0.0</span>                  <span class="c1"># Initial time</span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">0.1</span>            <span class="c1"># Final time</span>
<span class="n">dt_output</span><span class="o">=</span><span class="mf">0.021</span>          <span class="c1"># Interval between output for plotting</span>
<span class="n">N</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">dt_output</span><span class="p">)</span>       <span class="c1"># Number of output times</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CFL suggested time step&quot;</span><span class="p">,(</span><span class="mf">2.5</span><span class="o">*</span><span class="p">(</span><span class="mf">0.0198</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="n">Table</span><span class="p">[</span><span class="n">TIndex</span><span class="p">][</span><span class="s2">&quot;delta1&quot;</span><span class="p">],</span><span class="n">Table</span><span class="p">[</span><span class="n">TIndex</span><span class="p">][</span><span class="s2">&quot;delta2&quot;</span><span class="p">])));</span>
<span class="c1">#ODE = scipy.integrate.solve_ivp(Diffusion,[t0,tfinal],np.append(u0,v0,axis=0),args=[Table[TIndex]],method=&#39;RK45&#39;,t_eval=tt,atol=1.e-10,rtol=1.e-10);</span>
<span class="n">ODE</span> <span class="o">=</span> <span class="n">RK4</span><span class="p">(</span><span class="n">Diffusion</span><span class="p">,[</span><span class="n">t0</span><span class="p">,</span><span class="n">tfinal</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u0</span><span class="p">,</span><span class="n">v0</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">Table</span><span class="p">[</span><span class="n">TIndex</span><span class="p">],</span><span class="n">N</span><span class="p">);</span>
<span class="n">uu</span><span class="o">=</span><span class="n">ODE</span><span class="o">.</span><span class="n">y</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Step size of the Method&quot;</span><span class="p">,</span><span class="n">ODE</span><span class="o">.</span><span class="n">h</span><span class="p">);</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ODE</span><span class="o">.</span><span class="n">h</span><span class="o">*</span><span class="n">eigs</span><span class="p">(</span><span class="n">sparse</span><span class="o">.</span><span class="n">bmat</span><span class="p">([[</span><span class="n">Table</span><span class="p">[</span><span class="n">TIndex</span><span class="p">][</span><span class="s2">&quot;delta1&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="kc">None</span><span class="p">],[</span><span class="kc">None</span><span class="p">,</span><span class="n">Table</span><span class="p">[</span><span class="n">TIndex</span><span class="p">][</span><span class="s2">&quot;delta2&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">]]),</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">RK44</span> <span class="o">=</span> <span class="n">loadRKM</span><span class="p">(</span><span class="s1">&#39;RK44&#39;</span><span class="p">)</span>
<span class="n">RK44</span><span class="o">.</span><span class="n">plot_stability_region</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ODE</span><span class="o">.</span><span class="n">h</span><span class="o">*</span><span class="n">eigs</span><span class="p">(</span><span class="n">sparse</span><span class="o">.</span><span class="n">bmat</span><span class="p">([[</span><span class="n">Table</span><span class="p">[</span><span class="n">TIndex</span><span class="p">][</span><span class="s2">&quot;delta1&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="kc">None</span><span class="p">],[</span><span class="kc">None</span><span class="p">,</span><span class="n">Table</span><span class="p">[</span><span class="n">TIndex</span><span class="p">][</span><span class="s2">&quot;delta2&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">]]),</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">ODE</span><span class="o">.</span><span class="n">h</span><span class="o">*</span><span class="n">eigs</span><span class="p">(</span><span class="n">sparse</span><span class="o">.</span><span class="n">bmat</span><span class="p">([[</span><span class="n">Table</span><span class="p">[</span><span class="n">TIndex</span><span class="p">][</span><span class="s2">&quot;delta1&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="kc">None</span><span class="p">],[</span><span class="kc">None</span><span class="p">,</span><span class="n">Table</span><span class="p">[</span><span class="n">TIndex</span><span class="p">][</span><span class="s2">&quot;delta2&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">]]),</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span><span class="s2">&quot;b*&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CFL suggested time step 0.02722500000000001
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "45edcb24ffe4488e9a7e1ef8513f3dbb", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Step size of the Method 0.03333333333333333
[-3.0603    +0.j -3.0587903 +0.j -3.0587903 +0.j -3.0572806 +0.j
 -3.0572806 +0.j -3.0587903 +0.j -3.0587903 +0.j -3.0572806 +0.j
 -3.0572806 +0.j -3.05426716+0.j]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7f32ba2121f0&gt;]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_14_5.png" src="../_images/PDE_PatternFormationFD_14_5.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ut</span> <span class="o">=</span> <span class="n">uu</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
<span class="n">vt</span> <span class="o">=</span> <span class="n">uu</span><span class="p">[</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">:,</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
<span class="n">Ut</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">m</span><span class="p">,</span><span class="n">m</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Ut</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">Vt</span><span class="o">=</span><span class="n">vt</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">m</span><span class="p">,</span><span class="n">m</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Vt</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
&lt;ipython-input-12-14a28ac5572b&gt;:4: MatplotlibDeprecationWarning: shading=&#39;flat&#39; when X and Y have the same dimensions as C is deprecated since 3.3.  Either specify the corners of the quadrilaterals with X and Y, or pass shading=&#39;auto&#39;, &#39;nearest&#39; or &#39;gouraud&#39;, or set rcParams[&#39;pcolor.shading&#39;].  This will become an error two minor releases later.
  plt.pcolor(X,Y,Ut)
&lt;ipython-input-12-14a28ac5572b&gt;:8: MatplotlibDeprecationWarning: shading=&#39;flat&#39; when X and Y have the same dimensions as C is deprecated since 3.3.  Either specify the corners of the quadrilaterals with X and Y, or pass shading=&#39;auto&#39;, &#39;nearest&#39; or &#39;gouraud&#39;, or set rcParams[&#39;pcolor.shading&#39;].  This will become an error two minor releases later.
  plt.pcolor(X,Y,Vt)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_15_1.png" src="../_images/PDE_PatternFormationFD_15_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_15_2.png" src="../_images/PDE_PatternFormationFD_15_2.png" />
</div>
</div>
</div>
<div class="section" id="Reaction-Diffusion">
<h2>Reaction-Diffusion<a class="headerlink" href="#Reaction-Diffusion" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">ReactionDiffusion</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">parameters</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">];</span> <span class="n">v</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">:];</span> <span class="c1">#We grab the useful quantity.</span>
    <span class="n">d1</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;delta1&quot;</span><span class="p">];</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;delta2&quot;</span><span class="p">];</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;tau1&quot;</span><span class="p">];</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;tau2&quot;</span><span class="p">];</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">];</span> <span class="n">b</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;beta&quot;</span><span class="p">];</span> <span class="n">g</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;gamma&quot;</span><span class="p">];</span>
    <span class="c1">#Diffusion</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">bmat</span><span class="p">([[</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;delta1&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="kc">None</span><span class="p">],[</span><span class="kc">None</span><span class="p">,</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;delta2&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">]]);</span>
    <span class="c1">#Reaction</span>
    <span class="n">du</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">u</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">t1</span><span class="o">*</span><span class="p">(</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="n">v</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">t2</span><span class="o">*</span><span class="n">u</span><span class="p">);</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">t1</span><span class="o">/</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="p">))</span><span class="o">+</span><span class="n">u</span><span class="o">*</span><span class="p">(</span><span class="n">g</span><span class="o">+</span><span class="n">t2</span><span class="o">*</span><span class="n">v</span><span class="p">);</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">du</span><span class="p">,</span><span class="n">dv</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">B</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">b</span><span class="p">;</span>
<span class="n">TIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mf">0.0</span>                  <span class="c1"># Initial time</span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mi">150</span>            <span class="c1"># Final time</span>
<span class="n">dt_output</span><span class="o">=</span><span class="mf">0.0065</span>          <span class="c1"># Interval between output for plotting</span>
<span class="n">N</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">dt_output</span><span class="p">)</span>       <span class="c1"># Number of output times</span>
<span class="c1">#ODE = scipy.integrate.solve_ivp(Diffusion,[t0,tfinal],np.append(u0,v0,axis=0),args=[Table[TIndex]],method=&#39;RK45&#39;,t_eval=tt,atol=1.e-10,rtol=1.e-10);</span>
<span class="n">ODE</span> <span class="o">=</span> <span class="n">RK4</span><span class="p">(</span><span class="n">ReactionDiffusion</span><span class="p">,[</span><span class="n">t0</span><span class="p">,</span><span class="n">tfinal</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u0</span><span class="p">,</span><span class="n">v0</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">Table</span><span class="p">[</span><span class="n">TIndex</span><span class="p">],</span><span class="n">N</span><span class="p">);</span>
<span class="n">uu</span><span class="o">=</span><span class="n">ODE</span><span class="o">.</span><span class="n">y</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Step size of the Method&quot;</span><span class="p">,</span><span class="n">ODE</span><span class="o">.</span><span class="n">h</span><span class="p">);</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ODE</span><span class="o">.</span><span class="n">h</span><span class="o">*</span><span class="n">eigs</span><span class="p">(</span><span class="n">sparse</span><span class="o">.</span><span class="n">bmat</span><span class="p">([[</span><span class="n">Table</span><span class="p">[</span><span class="n">TIndex</span><span class="p">][</span><span class="s2">&quot;delta1&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="kc">None</span><span class="p">],[</span><span class="kc">None</span><span class="p">,</span><span class="n">Table</span><span class="p">[</span><span class="n">TIndex</span><span class="p">][</span><span class="s2">&quot;delta2&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">]]),</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">RK44</span> <span class="o">=</span> <span class="n">loadRKM</span><span class="p">(</span><span class="s1">&#39;RK44&#39;</span><span class="p">)</span>
<span class="n">RK44</span><span class="o">.</span><span class="n">plot_stability_region</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ODE</span><span class="o">.</span><span class="n">h</span><span class="o">*</span><span class="n">eigs</span><span class="p">(</span><span class="n">sparse</span><span class="o">.</span><span class="n">bmat</span><span class="p">([[</span><span class="n">Table</span><span class="p">[</span><span class="n">TIndex</span><span class="p">][</span><span class="s2">&quot;delta1&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="kc">None</span><span class="p">],[</span><span class="kc">None</span><span class="p">,</span><span class="n">Table</span><span class="p">[</span><span class="n">TIndex</span><span class="p">][</span><span class="s2">&quot;delta2&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">]]),</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">ODE</span><span class="o">.</span><span class="n">h</span><span class="o">*</span><span class="n">eigs</span><span class="p">(</span><span class="n">sparse</span><span class="o">.</span><span class="n">bmat</span><span class="p">([[</span><span class="n">Table</span><span class="p">[</span><span class="n">TIndex</span><span class="p">][</span><span class="s2">&quot;delta1&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="kc">None</span><span class="p">],[</span><span class="kc">None</span><span class="p">,</span><span class="n">Table</span><span class="p">[</span><span class="n">TIndex</span><span class="p">][</span><span class="s2">&quot;delta2&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">]]),</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span><span class="s2">&quot;b*&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "6b0c70cd450042dc8eb45091bbe9cc0e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Step size of the Method 0.0065005417118093175
[-0.59680823+0.j -0.59651382+0.j -0.59651382+0.j -0.5962194 +0.j
 -0.5962194 +0.j -0.59651382+0.j -0.59651382+0.j -0.5962194 +0.j
 -0.5962194 +0.j -0.59563173+0.j]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7f32b96476d0&gt;]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_17_4.png" src="../_images/PDE_PatternFormationFD_17_4.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ut</span> <span class="o">=</span> <span class="n">uu</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
<span class="n">vt</span> <span class="o">=</span> <span class="n">uu</span><span class="p">[</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">:,</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
<span class="n">Ut</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">m</span><span class="p">,</span><span class="n">m</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Ut</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">Vt</span><span class="o">=</span><span class="n">vt</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">m</span><span class="p">,</span><span class="n">m</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Vt</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
&lt;ipython-input-14-14a28ac5572b&gt;:4: MatplotlibDeprecationWarning: shading=&#39;flat&#39; when X and Y have the same dimensions as C is deprecated since 3.3.  Either specify the corners of the quadrilaterals with X and Y, or pass shading=&#39;auto&#39;, &#39;nearest&#39; or &#39;gouraud&#39;, or set rcParams[&#39;pcolor.shading&#39;].  This will become an error two minor releases later.
  plt.pcolor(X,Y,Ut)
&lt;ipython-input-14-14a28ac5572b&gt;:8: MatplotlibDeprecationWarning: shading=&#39;flat&#39; when X and Y have the same dimensions as C is deprecated since 3.3.  Either specify the corners of the quadrilaterals with X and Y, or pass shading=&#39;auto&#39;, &#39;nearest&#39; or &#39;gouraud&#39;, or set rcParams[&#39;pcolor.shading&#39;].  This will become an error two minor releases later.
  plt.pcolor(X,Y,Vt)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_18_1.png" src="../_images/PDE_PatternFormationFD_18_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_18_2.png" src="../_images/PDE_PatternFormationFD_18_2.png" />
</div>
</div>
</div>
<div class="section" id="Efficient-Reaction-Diffusion">
<h2>Efficient Reaction Diffusion<a class="headerlink" href="#Efficient-Reaction-Diffusion" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">Reaction</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">parameters</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">];</span> <span class="n">v</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">:];</span> <span class="c1">#We grab the useful quantity.</span>
    <span class="n">d1</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;delta1&quot;</span><span class="p">];</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;delta2&quot;</span><span class="p">];</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;tau1&quot;</span><span class="p">];</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;tau2&quot;</span><span class="p">];</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">];</span> <span class="n">b</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;beta&quot;</span><span class="p">];</span> <span class="n">g</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;gamma&quot;</span><span class="p">];</span>
    <span class="c1">#Reaction</span>
    <span class="n">du</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">u</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">t1</span><span class="o">*</span><span class="p">(</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="n">v</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">t2</span><span class="o">*</span><span class="n">u</span><span class="p">);</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">t1</span><span class="o">/</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="p">))</span><span class="o">+</span><span class="n">u</span><span class="o">*</span><span class="p">(</span><span class="n">g</span><span class="o">+</span><span class="n">t2</span><span class="o">*</span><span class="n">v</span><span class="p">);</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">du</span><span class="p">,</span><span class="n">dv</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">b</span><span class="p">;</span>
<span class="k">def</span> <span class="nf">SplitSolver</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">U0</span><span class="p">,</span><span class="n">arg</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">);</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">tt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tt</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">U0</span><span class="p">),</span><span class="n">N</span><span class="p">]);</span>
    <span class="n">U</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">U0</span><span class="p">;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">trange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">bmat</span><span class="p">([[</span><span class="n">arg</span><span class="p">[</span><span class="s2">&quot;delta1&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="kc">None</span><span class="p">],[</span><span class="kc">None</span><span class="p">,</span><span class="n">arg</span><span class="p">[</span><span class="s2">&quot;delta2&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">]]);</span>
        <span class="n">UStar</span> <span class="o">=</span> <span class="n">spsolve</span><span class="p">((</span><span class="n">sparse</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="n">B</span><span class="p">),</span><span class="n">U</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span>
        <span class="n">Y1</span> <span class="o">=</span> <span class="n">UStar</span><span class="p">;</span>
        <span class="n">Y2</span> <span class="o">=</span> <span class="n">UStar</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">tt</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">Y1</span><span class="p">,</span><span class="n">arg</span><span class="p">);</span>
        <span class="n">Y3</span> <span class="o">=</span> <span class="n">UStar</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">tt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="p">,</span><span class="n">Y2</span><span class="p">,</span><span class="n">arg</span><span class="p">);</span>
        <span class="n">Y4</span> <span class="o">=</span> <span class="n">UStar</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">tt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="p">,</span><span class="n">Y3</span><span class="p">,</span><span class="n">arg</span><span class="p">);</span>
        <span class="n">U</span><span class="p">[:,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">UStar</span><span class="o">+</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">tt</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">Y1</span><span class="p">,</span><span class="n">arg</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">tt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="p">,</span><span class="n">Y2</span><span class="p">,</span><span class="n">arg</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">tt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="p">,</span><span class="n">Y3</span><span class="p">,</span><span class="n">arg</span><span class="p">)</span><span class="o">+</span><span class="n">F</span><span class="p">(</span><span class="n">tt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">h</span><span class="p">,</span><span class="n">Y4</span><span class="p">,</span><span class="n">arg</span><span class="p">))</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="k">100</span>==0):
            <span class="n">Ut</span><span class="o">=</span><span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">m</span><span class="p">,</span><span class="n">m</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Ut</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">ODESol</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">U</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">sol</span><span class="p">;</span>
<span class="n">TIndex</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mf">0.0</span>                  <span class="c1"># Initial time</span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mi">150</span>            <span class="c1"># Final time</span>
<span class="n">dt_output</span><span class="o">=</span><span class="mf">0.1</span>          <span class="c1"># Interval between output for plotting</span>
<span class="n">N</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">dt_output</span><span class="p">)</span>       <span class="c1"># Number of output times</span>
<span class="c1">#ODE = scipy.integrate.solve_ivp(Diffusion,[t0,tfinal],np.append(u0,v0,axis=0),args=[Table[TIndex]],method=&#39;RK45&#39;,t_eval=tt,atol=1.e-10,rtol=1.e-10);</span>
<span class="n">ODE</span> <span class="o">=</span> <span class="n">SplitSolver</span><span class="p">(</span><span class="n">Reaction</span><span class="p">,[</span><span class="n">t0</span><span class="p">,</span><span class="n">tfinal</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u0</span><span class="p">,</span><span class="n">v0</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">Table</span><span class="p">[</span><span class="n">TIndex</span><span class="p">],</span><span class="n">N</span><span class="p">);</span>
<span class="n">uu</span><span class="o">=</span><span class="n">ODE</span><span class="o">.</span><span class="n">y</span>
<span class="n">ut</span> <span class="o">=</span> <span class="n">uu</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
<span class="n">vt</span> <span class="o">=</span> <span class="n">uu</span><span class="p">[</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">:,</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
<span class="n">Ut</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">m</span><span class="p">,</span><span class="n">m</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Ut</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">Vt</span><span class="o">=</span><span class="n">vt</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">m</span><span class="p">,</span><span class="n">m</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Vt</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e3001aea68224f42a712bb0f2790c255", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
&lt;ipython-input-15-45dc21ecdffc&gt;:26: MatplotlibDeprecationWarning: shading=&#39;flat&#39; when X and Y have the same dimensions as C is deprecated since 3.3.  Either specify the corners of the quadrilaterals with X and Y, or pass shading=&#39;auto&#39;, &#39;nearest&#39; or &#39;gouraud&#39;, or set rcParams[&#39;pcolor.shading&#39;].  This will become an error two minor releases later.
  plt.pcolor(X,Y,Ut)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_20_2.png" src="../_images/PDE_PatternFormationFD_20_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_20_3.png" src="../_images/PDE_PatternFormationFD_20_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_20_4.png" src="../_images/PDE_PatternFormationFD_20_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_20_5.png" src="../_images/PDE_PatternFormationFD_20_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_20_6.png" src="../_images/PDE_PatternFormationFD_20_6.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_20_7.png" src="../_images/PDE_PatternFormationFD_20_7.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_20_8.png" src="../_images/PDE_PatternFormationFD_20_8.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_20_9.png" src="../_images/PDE_PatternFormationFD_20_9.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_20_10.png" src="../_images/PDE_PatternFormationFD_20_10.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_20_11.png" src="../_images/PDE_PatternFormationFD_20_11.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_20_12.png" src="../_images/PDE_PatternFormationFD_20_12.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_20_13.png" src="../_images/PDE_PatternFormationFD_20_13.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_20_14.png" src="../_images/PDE_PatternFormationFD_20_14.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_20_15.png" src="../_images/PDE_PatternFormationFD_20_15.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_20_16.png" src="../_images/PDE_PatternFormationFD_20_16.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
&lt;ipython-input-15-45dc21ecdffc&gt;:42: MatplotlibDeprecationWarning: shading=&#39;flat&#39; when X and Y have the same dimensions as C is deprecated since 3.3.  Either specify the corners of the quadrilaterals with X and Y, or pass shading=&#39;auto&#39;, &#39;nearest&#39; or &#39;gouraud&#39;, or set rcParams[&#39;pcolor.shading&#39;].  This will become an error two minor releases later.
  plt.pcolor(X,Y,Ut)
&lt;ipython-input-15-45dc21ecdffc&gt;:46: MatplotlibDeprecationWarning: shading=&#39;flat&#39; when X and Y have the same dimensions as C is deprecated since 3.3.  Either specify the corners of the quadrilaterals with X and Y, or pass shading=&#39;auto&#39;, &#39;nearest&#39; or &#39;gouraud&#39;, or set rcParams[&#39;pcolor.shading&#39;].  This will become an error two minor releases later.
  plt.pcolor(X,Y,Vt)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_20_18.png" src="../_images/PDE_PatternFormationFD_20_18.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/PDE_PatternFormationFD_20_19.png" src="../_images/PDE_PatternFormationFD_20_19.png" />
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">NumSA</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted.html">NumSA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TensorFlow/index.html">TensorFlow</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Partial Differential Equations (PDE)</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Pattern Formation PDE – Finite Difference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Reaction">Reaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Diffusion">Diffusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Reaction-Diffusion">Reaction-Diffusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Efficient-Reaction-Diffusion">Efficient Reaction Diffusion</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Partial Differential Equations (PDE)</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Partial Differential Equations (PDE)</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Umberto Zerbinati.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="../_sources/PDE/PatternFormationFD.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>